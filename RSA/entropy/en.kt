import kotlin.math.log2


fun main(args: Array<String>){

    // pembangkitan 1 - cipherText
    // val dataList = mutableListOf<Int>(
    //     927, 6844, 6844, 6844, 6844, 4812, 4812, 4812, 4019, 4434, 9142, 6917, 6844, 8842, 2865, 6917, 5211, 6844, 4803, 6917, 8222, 4434, 8222, 4434, 4498, 6844, 3759, 5551, 5950, 1487, 8956, 445, 1487, 4897, 8956, 6844, 5551, 8956, 2940, 2018, 2018, 7691, 4812, 4812, 4812, 927, 6844, 6844, 6844, 6844, 1090, 4158, 1163, 1163, 4158, 5348, 4158, 7576, 4571, 6851, 4158, 5348, 4158, 6917, 2858, 4571, 7576, 6844, 1560, 4158, 2865, 2865, 4158, 8619, 7576, 4158, 640, 4571, 5348, 5348, 4158, 8619, 6917, 6844, 1560, 4158, 753, 4158, 2865, 4158, 2858, 4158, 640, 4571, 8619, 1090, 927, 6844, 6844, 6844, 6844, 4121, 1212, 5809, 5809, 927, 6844, 6844, 6844, 6844, 8424, 4783, 8842, 3490, 8842, 3490, 8842, 7021, 459, 73, 8842, 1000, 8842, 2091, 8697, 5690, 9095, 4246, 2792, 927, 6844, 6844, 6844, 6844, 4926, 753, 4158, 640, 6844, 2858, 3900, 8619, 6917, 8222, 4571, 6924, 4158, 2206, 6844, 4158, 8222, 4158, 5348, 4158, 8619, 6844, 1163, 3900, 8222, 3900, 2865, 8619, 4158, 2206, 4158, 1487, 927, 6844, 6844, 6844, 6844, 1000, 3900, 8222, 3900, 2865, 8619, 4158, 2206, 4158, 6844, 6917, 640, 4571, 6844, 623, 4158, 2865, 4158, 6844, 8619, 6917, 8222, 4571, 6924, 1487, 927, 6844, 6844, 6844, 6844, 4783, 4158, 2865, 4158, 6844, 8619, 6917, 8222, 4571, 6924, 6844, 6917, 640, 4571, 6844, 1163, 3900, 8222, 3900, 2865, 8619, 4158, 2206, 4158, 1487, 6844, 5275, 1163, 6917, 7576, 6924, 3900, 5348, 5809, 5809, 6219, 927, 6844, 6844, 6844, 6844
    //     )
    // pembangkitan 2 - cipherText
    // val dataList = mutableListOf<Int>(
    //     4165, 1572, 1572, 1572, 1572, 5364, 5364, 5364, 3904, 2570, 2634, 10926, 1572, 5276, 1161, 10926, 5856, 1572, 6214, 10926, 12168, 2570, 12168, 2570, 4646, 1572, 11696, 11944, 2754, 12313, 1505, 2065, 12313, 11193, 1505, 1572, 11944, 1505, 5145, 9818, 9818, 4088, 5364, 5364, 5364, 4165, 1572, 1572, 1572, 1572, 5079, 7010, 11539, 11539, 7010, 8635, 7010, 4444, 4739, 10735, 7010, 8635, 7010, 10926, 12216, 4739, 4444, 1572, 3863, 7010, 1161, 1161, 7010, 10322, 4444, 7010, 12117, 4739, 8635, 8635, 7010, 10322, 10926, 1572, 3863, 7010, 12585, 7010, 1161, 7010, 12216, 7010, 12117, 4739, 10322, 5079, 4165, 1572, 1572, 1572, 1572, 607, 3397, 9817, 9817, 4165, 1572, 1572, 1572, 1572, 11196, 5861, 5276, 1616, 5276, 1616, 5276, 8386, 9196, 11491, 5276, 9425, 5276, 9844, 4407, 7314, 2822, 554, 11708, 4165, 1572, 1572, 1572, 1572, 8951, 12585, 7010, 12117, 1572, 12216, 2716, 10322, 10926, 12168, 4739, 7062, 7010, 6278, 1572, 7010, 12168, 7010, 8635, 7010, 10322, 1572, 11539, 2716, 12168, 2716, 1161, 10322, 7010, 6278, 7010, 12313, 4165, 1572, 1572, 1572, 1572, 9425, 2716, 12168, 2716, 1161, 10322, 7010, 6278, 7010, 1572, 10926, 12117, 4739, 1572, 10619, 7010, 1161, 7010, 1572, 10322, 10926, 12168, 4739, 7062, 12313, 4165, 1572, 1572, 1572, 1572, 5861, 7010, 1161, 7010, 1572, 10322, 10926, 12168, 4739, 7062, 1572, 10926, 12117, 4739, 1572, 11539, 2716, 12168, 2716, 1161, 10322, 7010, 6278, 7010, 12313, 1572, 10981, 11539, 10926, 4444, 7062, 2716, 8635, 9817, 9817, 9661, 4165, 1572, 1572, 1572, 1572
    //     )
    // pembangkitan 3 - cipherText
    // val dataList = mutableListOf<Int>(
    //     14223, 3457, 3457, 3457, 3457, 12387, 12387, 12387, 12541, 12793, 15422, 5704, 3457, 9499, 10871, 5704, 145, 3457, 11313, 5704, 15508, 12793, 15508, 12793, 4035, 3457, 13073, 8531, 15261, 16313, 11790, 9464, 16313, 4413, 11790, 3457, 8531, 11790, 1707, 5181, 5181, 4761, 12387, 12387, 12387, 14223, 3457, 3457, 3457, 3457, 12583, 4783, 13666, 13666, 4783, 16221, 4783, 515, 4500, 14225, 4783, 16221, 4783, 5704, 9994, 4500, 515, 3457, 4380, 4783, 10871, 10871, 4783, 13954, 515, 4783, 14013, 4500, 16221, 16221, 4783, 13954, 5704, 3457, 4380, 4783, 4973, 4783, 10871, 4783, 9994, 4783, 14013, 4500, 13954, 12583, 14223, 3457, 3457, 3457, 3457, 1070, 2974, 8488, 8488, 14223, 3457, 3457, 3457, 3457, 3240, 11825, 9499, 15937, 9499, 15937, 9499, 2318, 13293, 15989, 9499, 8632, 9499, 6222, 15301, 16002, 10513, 5452, 12566, 14223, 3457, 3457, 3457, 3457, 3544, 4973, 4783, 14013, 3457, 9994, 14405, 13954, 5704, 15508, 4500, 13887, 4783, 3265, 3457, 4783, 15508, 4783, 16221, 4783, 13954, 3457, 13666, 14405, 15508, 14405, 10871, 13954, 4783, 3265, 4783, 16313, 14223, 3457, 3457, 3457, 3457, 8632, 14405, 15508, 14405, 10871, 13954, 4783, 3265, 4783, 3457, 5704, 14013, 4500, 3457, 2119, 4783, 10871, 4783, 3457, 13954, 5704, 15508, 4500, 13887, 16313, 14223, 3457, 3457, 3457, 3457, 11825, 4783, 10871, 4783, 3457, 13954, 5704, 15508, 4500, 13887, 3457, 5704, 14013, 4500, 3457, 13666, 14405, 15508, 14405, 10871, 13954, 4783, 3265, 4783, 16313, 3457, 12944, 13666, 5704, 515, 13887, 14405, 16221, 8488, 8488, 1733, 14223, 3457, 3457, 3457, 3457
    //     )
    // pembangkitan 4 - cipherText
    // val dataList = mutableListOf<Int>(
    //     7659, 10982, 10982, 10982, 10982, 12566, 12566, 12566, 11899, 9726, 4873, 9879, 10982, 5214, 7453, 9879, 3423, 10982, 7555, 9879, 3925, 9726, 3925, 9726, 12339, 10982, 10650, 839, 3568, 940, 6463, 75, 940, 690, 6463, 10982, 839, 6463, 2320, 9023, 9023, 3038, 12566, 12566, 12566, 7659, 10982, 10982, 10982, 10982, 981, 2182, 5793, 5793, 2182, 10362, 2182, 11433, 12147, 6637, 2182, 10362, 2182, 9879, 3359, 12147, 11433, 10982, 6641, 2182, 7453, 7453, 2182, 7600, 11433, 2182, 1911, 12147, 10362, 10362, 2182, 7600, 9879, 10982, 6641, 2182, 1425, 2182, 7453, 2182, 3359, 2182, 1911, 12147, 7600, 981, 7659, 10982, 10982, 10982, 10982, 10573, 12769, 11886, 11886, 7659, 10982, 10982, 10982, 10982, 6374, 6700, 5214, 7015, 5214, 7015, 5214, 3800, 4823, 8502, 5214, 33, 5214, 7853, 5461, 8019, 1962, 9741, 11166, 7659, 10982, 10982, 10982, 10982, 1725, 1425, 2182, 1911, 10982, 3359, 7331, 7600, 9879, 3925, 12147, 831, 2182, 9584, 10982, 2182, 3925, 2182, 10362, 2182, 7600, 10982, 5793, 7331, 3925, 7331, 7453, 7600, 2182, 9584, 2182, 940, 7659, 10982, 10982, 10982, 10982, 33, 7331, 3925, 7331, 7453, 7600, 2182, 9584, 2182, 10982, 9879, 1911, 12147, 10982, 11183, 2182, 7453, 2182, 10982, 7600, 9879, 3925, 12147, 831, 940, 7659, 10982, 10982, 10982, 10982, 6700, 2182, 7453, 2182, 10982, 7600, 9879, 3925, 12147, 831, 10982, 9879, 1911, 12147, 10982, 5793, 7331, 3925, 7331, 7453, 7600, 2182, 9584, 2182, 940, 10982, 9453, 5793, 9879, 11433, 831, 7331, 10362, 11886, 11886, 1623, 7659, 10982, 10982, 10982, 10982
    //     )
    // pembangkitan 5 - cipherText
    // val dataList = mutableListOf<Int>(
    //     2177, 32, 32, 32, 32, 2657, 2657, 2657, 2650, 5036, 2270, 2863, 32, 2626, 4054, 2863, 3057, 32, 284, 2863, 297, 5036, 297, 5036, 1226, 32, 5607, 4974, 5965, 2410, 1230, 3992, 2410, 3399, 1230, 32, 4974, 1230, 2619, 3205, 3205, 93, 2657, 2657, 2657, 2177, 32, 32, 32, 32, 3785, 3643, 3267, 3267, 3643, 2472, 3643, 3852, 6027, 4373, 3643, 2472, 3643, 2863, 5032, 6027, 3852, 32, 316, 3643, 4054, 4054, 3643, 3847, 3852, 3643, 1889, 6027, 2472, 2472, 3643, 3847, 2863, 32, 316, 3643, 6008, 3643, 4054, 3643, 5032, 3643, 1889, 6027, 3847, 3785, 2177, 32, 32, 32, 32, 5576, 624, 4970, 4970, 2177, 32, 32, 32, 32, 2995, 5977, 2626, 3236, 2626, 3236, 2626, 3821, 3612, 3816, 2626, 4023, 2626, 717, 2415, 254, 253, 1827, 2208, 2177, 32, 32, 32, 32, 1261, 6008, 3643, 1889, 32, 5032, 4435, 3847, 2863, 297, 6027, 3461, 3643, 1292, 32, 3643, 297, 3643, 2472, 3643, 3847, 32, 3267, 4435, 297, 4435, 4054, 3847, 3643, 1292, 3643, 2410, 2177, 32, 32, 32, 32, 4023, 4435, 297, 4435, 4054, 3847, 3643, 1292, 3643, 32, 2863, 1889, 6027, 32, 6009, 3643, 4054, 3643, 32, 3847, 2863, 297, 6027, 3461, 2410, 2177, 32, 32, 32, 32, 5977, 3643, 4054, 3643, 32, 3847, 2863, 297, 6027, 3461, 32, 2863, 1889, 6027, 32, 3267, 4435, 297, 4435, 4054, 3847, 3643, 1292, 3643, 2410, 32, 3581, 3267, 2863, 3852, 3461, 4435, 2472, 4970, 4970, 62, 2177, 32, 32, 32, 32
    //     )

    // experiment Increase Entropy 5 - cipherText
    val dataList = mutableListOf<Int>(
        10, 32, 32, 32, 32, 96, 96, 96, 89, 111, 103, 105, 32, 65, 114, 105, 102, 32, 87, 105, 100, 111, 100, 111, 44, 32, 91, 49, 55, 46, 48, 52, 46, 50, 48, 32, 49, 48, 58, 53, 53, 93, 96, 96, 96, 10, 32, 32, 32, 32, 42, 97, 115, 115, 97, 108, 97, 109, 117, 39, 97, 108, 97, 105, 107, 117, 109, 32, 119, 97, 114, 114, 97, 104, 109, 97, 116, 117, 108, 108, 97, 104, 105, 32, 119, 97, 98, 97, 114, 97, 107, 97, 116, 117, 104, 42, 10, 32, 32, 32, 32, 60, 33, 45, 45, 10, 32, 32, 32, 32, 40, 67, 65, 84, 65, 84, 65, 78, 66, 73, 65, 83, 65, 126, 51, 57, 56, 54, 41, 10, 32, 32, 32, 32, 79, 98, 97, 116, 32, 107, 101, 104, 105, 100, 117, 112, 97, 110, 32, 97, 100, 97, 108, 97, 104, 32, 115, 101, 100, 101, 114, 104, 97, 110, 97, 46, 10, 32, 32, 32, 32, 83, 101, 100, 101, 114, 104, 97, 110, 97, 32, 105, 116, 117, 32, 99, 97, 114, 97, 32, 104, 105, 100, 117, 112, 46, 10, 32, 32, 32, 32, 67, 97, 114, 97, 32, 104, 105, 100, 117, 112, 32, 105, 116, 117, 32, 115, 101, 100, 101, 114, 104, 97, 110, 97, 46, 32, 35, 115, 105, 109, 112, 101, 108, 45, 45, 62, 10, 32, 32, 32, 32
        )
    // experiment p
    // val dataList = mutableListOf<Int>(
    //     73,47,83,67,31
    //     )
    // experiment q
    // val dataList = mutableListOf<Int>(
    //     131,271,197,197,197
    //     )
    val counterData = dataList
                    .groupingBy { it }      // grouping data
                    .eachCount()        // probabilitas data
                    .filter {       // filter data | optional
                        it.value > 0
                    }
    val counterDataValue = counterData.values       // ambil value

    // check initialize
    println("""
    listData : $dataList

    listData Size ${dataList.size}

    counterData : $counterData

    counterData Values : $counterDataValue

    CounterData Value Size ${counterDataValue.size}
    """.trimIndent())

    var entropy = 0.0 // initialize entopy

    for (count in counterDataValue){ // loop for probability data value
        // println(count)
        var pX = count.toDouble() / dataList.size
        // println(pX)
        entropy += - pX * log2(pX)      // formula entropy
        // println(entropy)
    }
    println("entropy : $entropy")

}